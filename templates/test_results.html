
{% extends 'base.html' %}
{% block header %}
  <h1>{% block title %}Results{% endblock %}</h1>
{% endblock %}

{% block content %}
    <div class="container">
        <!-- The results get posted here -->
        <div class="ui top attached tabular menu">
            <a class="active item" data-tab="table">Table</a>
            <a class="item" data-tab="chart">Chart</a>
        </div>
        <div class="ui bottom attached active tab segment" data-tab="table">
            {% if table_result %}
                    <div class="ui two column centered padded grid">
                        <!-- summary results -->
                        <div class="section">
                            <table class="ui very basic collapsing celled table">
                                <thead>
                                    <tr>
                                        <th style="border: 0px !important;"></th>
                                        <th colspan='2' style="border-left: 0px !important;">Dates</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td ></td>
                                        <td style="border: 0px !important;">
                                            <h4 class="ui header">
                                                <div class="content">
                                                    Date of Birth
                                                    <div class="sub header"></div>
                                                </div>
                                            </h4>
                                        </td>
                                        <td>
                                            {{table_result[0].birth_data.birth_date}}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;"></td>
                                        <td style="border-left: 0px !important;">
                                            <h4 class="ui header">
                                                <div class="content">
                                                    Date of measurement
                                                    <div class="sub header"></div>
                                                </div>
                                            </h4>
                                        </td>
                                        <td>
                                            {{table_result[0].measurement_dates.observation_date}}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;"></td>
                                        <td style="border-left: 0px !important;">
                                            <h4 class="ui header">
                                                <div class="content">
                                                    Sex
                                                    <div class="sub header"></div>
                                                </div>
                                            </h4>
                                        </td>
                                        <td>
                                            {{table_result[0].birth_data.sex}}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;" id="gestational_age_delivery_explain">
                                            <i class="info green circle icon"></i>
                                        </td>
                                        <td style="border-left: 0px !important;">
                                            <h4 class="ui header">
                                                <div class="content">
                                                    Gestational Age at Delivery (Postmenstrual age)
                                                    <div class="sub header"></div>
                                                </div>
                                            </h4>
                                        </td>
                                        <td>
                                            {{table_result[0].birth_data.gestation_weeks}}<sup>+{{table_result[0].birth_data.gestation_days}}</sup> weeks
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;" id="chronological_decimal_age_explain">
                                            <i class="info green circle icon"></i>
                                        </td>
                                        <td style="border-left: 0px !important;">
                                            <h4 class="ui header">
                                                
                                                <div class="content">
                                                    Chronological Decimal Age
                                                    <div class="sub header">                                
                                                    </div>
                                                </div>
                                            </h4>
                                        </td>
                                        <td>
                                            {{table_result[0].measurement_dates.chronological_decimal_age|round(3)}} y
                                        </td>
                                        <!-- <td class='chronological_decimal_age'>
                                            <i class="info green circle icon"></i>
                                        </td> -->
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;" id="corrected_decimal_age_explain">
                                            <i class="info green circle icon"></i>
                                        </td>
                                        <td style="border-left: 0px !important;">
                                            <h4 class="ui image header">
                                                <div class="content">
                                                    Corrected Decimal Age
                                                    <div class="sub header"></div>
                                                </div>
                                            </h4>
                                        </td>
                                        {% if table_result[0].measurement_dates.corrected_decimal_age != 'None' %}
                                        <td>
                                            {{table_result[0].measurement_dates.corrected_decimal_age|round(3)}} y
                                        </td>
                                        <td id='corrected_decimal_age' style="border: 0px !important;">
                                            <i class="info green circle icon"></i>
                                        </td>
                                        {% else %}
                                        <td>
                                            No correction needed
                                        </td>
                                        {% endif %}
                                        <!-- <td class='chronological_decimal_age'>
                                            <i class="info green circle icon"></i>
                                        </td> -->
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;" id="chronological_calendar_age_explain">
                                            <i class="info green circle icon"></i>
                                        </td>
                                        <td style="border-left: 0px !important;">
                                            <h4 class="ui image header">
                                                <div class="content">
                                                    <div class="sub header"></div>
                                                    Chronological Calendar Age
                                                </div>
                                            </h4>
                                        </td>
                                        <td>
                                            {{table_result[0].measurement_dates.chronological_calendar_age}}
                                        </td>
                                        <!-- <td class='chronological_decimal_age'>
                                            <i class="info green circle icon"></i>
                                        </td> -->
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;" id="corrected_calendar_age_explain">
                                            <i class="info green circle icon"></i>
                                        </td>
                                        <td style="border-left: 0px !important;">
                                        <h4 class="ui image header">
                                            
                                            <div class="content">
                                            Corrected Calendar Age
                                            <div class="sub header">
                                            </div>
                                        </div>
                                        </h4></td>
                                        {% if table_result[0].measurement_dates.corrected_calendar_age %}
                                        <td>
                                            {{table_result[0].measurement_dates.corrected_calendar_age}}
                                        </td>
                                        {% else %}
                                            <td>
                                                No correction needed
                                            </td>
                                        {% endif %}
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;" id="estimated_date_delivery_explain">
                                            <i class="info green circle icon"></i>
                                        </td>
                                        <td style="border-left: 0px !important;">
                                        <h4 class="ui image header">
                                            
                                            <div class="content">
                                            Estimated Date of Delivery
                                            <div class="sub header">
                                            </div>
                                        </div>
                                        </h4></td>
                                        {% if table_result[0].birth_data.estimated_date_delivery_string %}
                                        <td>
                                            {{ table_result[0].birth_data.estimated_date_delivery_string }}
                                        </td>
                                        <!-- <td class='chronological_decimal_age'>
                                            <i class="info green circle icon"></i>
                                        </td> -->
                                        {% else %}
                                            <td>
                                                No correction needed
                                            </td>
                                        {% endif %}
                                    </tr>
                                    <tr>
                                        <td style="border: 0px !important;" id="corrected_gestational_age_explain">
                                            <i class="info green circle icon"></i>
                                        </td>
                                        <td style="border-left: 0px !important;">
                                            <h4 class="ui image header">
                                                <div class="content">
                                                Corrected Gestational Age (Postmenstrual Age after birth)
                                                </div>
                                            </h4>
                                        </td>
                                        {% if table_result[0].measurement_dates.corrected_gestational_age.corrected_gestation_weeks %}
                                        <td>
                                            {{table_result[0].measurement_dates.corrected_gestational_age.corrected_gestation_weeks}}<sup>+{{table_result[0].measurement_dates.corrected_gestational_age.corrected_gestation_days}}</sup> weeks
                                        </td>
                                        {% else %}
                                            <td>
                                                No correction needed
                                            </td>
                                        {% endif %}
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- measurement table_results -->
                        <div class="section">
                            <table class="ui very basic collapsing celled table">
                                <thead>
                                    <tr>
                                        <th colspan='2'>Measurements</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <h4 class="ui blue header">
                                                <div class="content">
                                                    Height
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                            {% if measurement.child_observation_value.measurement_type == 'height' %}
                                                <td>
                                                    {{ measurement.child_observation_value.measurement_value|round(1) }} cm
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui header">
                                                <div class="content">
                                                    SDS
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                        {% if measurement.child_observation_value.measurement_type == 'height' %}
                                            <td>
                                                <div>
                                                    {{ measurement.measurement_calculated_values.sds|round(2) }}
                                                </div>
                                            </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui header">
                                                <div class="content">
                                                    Centile
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                            {% if measurement.child_observation_value.measurement_type == 'height' %}
                                                <td>
                                                    <div class="ui blue header">
                                                        {% if (measurement.measurement_calculated_values.centile >99 and measurement.measurement_calculated_values.centile < 100) or (measurement.measurement_calculated_values.centile < 1 and measurement.measurement_calculated_values.centile > 0) %}
                                                            {{ measurement.measurement_calculated_values.centile|round(1) }}
                                                        {% elif measurement.measurement_calculated_values.centile >= 100 %}
                                                            >99.6<sup>th</sup>
                                                        {% elif measurement.measurement_calculated_values.centile <= 0%}
                                                            < 0.4<sup>th</sup>
                                                        {% else %}
                                                            {{ measurement.measurement_calculated_values.centile|round|int}}
                                                        {% endif %}
                                                    </div>
                                                    <td id='height_centile' style="border: 0px !important;">
                                                        <i class="info green circle icon"></i>
                                                    </td>
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui blue header">
                                                <div class="content">
                                                    Weight
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                            {% if measurement.child_observation_value.measurement_type == 'weight' %}
                                                <td>
                                                    {{ measurement.child_observation_value.measurement_value|round(2) }} kg
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui header">
                                                <div class="content">
                                                    SDS
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                            {% if measurement.child_observation_value.measurement_type == 'weight' %}
                                                <td>
                                                    <div >
                                                        {{ measurement.measurement_calculated_values.sds|round(2) }}
                                                    </div>
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui header">
                                                <div class="content">
                                                    Centile
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result  %}
                                            {% if measurement.child_observation_value.measurement_type == 'weight' %}
                                                <td>
                                                    <div class="ui blue header">
                                                        {% if (measurement.measurement_calculated_values.centile >99 and measurement.measurement_calculated_values.centile < 100) or (measurement.measurement_calculated_values.centile < 1 and measurement.measurement_calculated_values.centile > 0) %}
                                                            {{ measurement.measurement_calculated_values.centile|round(1) }}
                                                        {% elif measurement.measurement_calculated_values.centile >= 100 %}
                                                            >99.6<sup>th</sup>
                                                        {% elif measurement.measurement_calculated_values.centile <= 0%}
                                                            < 0.4<sup>th</sup>
                                                        {% else %}
                                                            {{ measurement.measurement_calculated_values.centile|round|int}}
                                                        {% endif %}
                                                    </div>
                                                </td>
                                                <td id='weight_centile' style=" border: 0px !important;">
                                                    <i class="info green circle icon"></i>
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui blue header">
                                                <div class="content">
                                                    BMI
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result  %}
                                            {% if measurement.child_observation_value.measurement_type == 'bmi' %}
                                                <td>
                                                    {{ measurement.child_observation_value.measurement_value|round(1) }} kg/m&#178;
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui header">
                                                <div class="content">
                                                    SDS
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                            {% if measurement.child_observation_value.measurement_type == 'bmi' %}
                                                <td>
                                                    <div>
                                                        {{ measurement.measurement_calculated_values.sds|round(2) }}
                                                    </div>
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui header">
                                                <div class="content">
                                                    Centile
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                            {% if measurement.child_observation_value.measurement_type == 'bmi' %}
                                                    <td>
                                                        <div class="ui blue header">
                                                            {% if (measurement.measurement_calculated_values.centile >99 and measurement.measurement_calculated_values.centile < 100) or (measurement.measurement_calculated_values.centile < 1 and measurement.measurement_calculated_values.centile > 0) %}
                                                                {{ measurement.measurement_calculated_values.centile|round(1) }}
                                                            {% elif measurement.measurement_calculated_values.centile >= 100 %}
                                                                >99.6<sup>th</sup>
                                                            {% elif measurement.measurement_calculated_values.centile <= 0%}
                                                                < 0.4<sup>th</sup>
                                                            {% else %}
                                                                {{ measurement.measurement_calculated_values.centile|round|int}}
                                                            {% endif %}
                                                        </div>
                                                    </td>
                                                    <td id='bmi_centile' style=" border: 0px !important;">
                                                        <i class="info green circle icon"></i>
                                                    </td>
                                                {% endif %}

                                            {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui blue header">
                                                <div class="content">
                                                    Head Circumference
                                                    <div class="sub header">
                                                    </div>
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                            {% if measurement.child_observation_value.measurement_type == 'ofc' %}
                                                <td>
                                                    {{ measurement.child_observation_value.measurement_value }} cm
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui header">
                                                <div class="content">
                                                    SDS
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result %}
                                            {% if measurement.child_observation_value.measurement_type == 'ofc' %}
                                                <td>
                                                    <div>
                                                        {{ measurement.measurement_calculated_values.sds|round(2) }}
                                                    </div>
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 class="ui header">
                                                <div class="content">
                                                    Centile
                                                </div>
                                            </h4>
                                        </td>
                                        {% for measurement in table_result  %}
                                            {% if measurement.child_observation_value.measurement_type == 'ofc' %}
                                                <td>
                                                    <div class="ui blue header">
                                                        {% if (measurement.measurement_calculated_values.centile >99 and measurement.measurement_calculated_values.centile < 100) or (measurement.measurement_calculated_values.centile < 1 and measurement.measurement_calculated_values.centile > 0) %}
                                                            {{ measurement.measurement_calculated_values.centile|round(1) }}
                                                        {% elif measurement.measurement_calculated_values.centile >= 100 %}
                                                            >99.6<sup>th</sup>
                                                        {% elif measurement.measurement_calculated_values.centile <= 0%}
                                                            < 0.4<sup>th</sup>
                                                        {% else %}
                                                            {{ measurement.measurement_calculated_values.centile|round|int}}
                                                        {% endif %}
                                                    </div>
                                                </td>
                                                <td id='ofc_centile' style=" border: 0px !important; ">
                                                    <i class="info green circle icon"></i>
                                                </td>
                                            {% endif %}
                                        {% endfor %}
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
            {% endif %}
        </div>
        <div class="ui bottom attached tab segment" data-tab="chart">
            <!---Charts start here-->
            <div class="ui centered aligned grid">
                <div class="ui container">
                  <canvas id="heightChart" width="200" height="200"></canvas>        
                </div>
                <div class="ui container">
                  <canvas id="weightChart" width="200" height="200"></canvas>        
                </div>
                <div class="ui container">
                  <canvas id="bmiChart" width="200" height="200"></canvas>
                </div>
                <div class="ui container">
                  <canvas id="ofcChart" width="200" height="200"></canvas>
                </div>
              </div>    
        </div>
    </div>
<script type="text/javascript">
    // javascript for the table
    {% include 'table.js' %}
    /// javascript for the charts
    {% include 'growthcharts.js' %}
</script>
                
{% endblock %}